# 数据传递、事件、渲染

## 目录

[Props：父传子](#jump1)

[React数据传递：子传父](#jump2)

[REACT事件](#jump3)
                      
[React条件渲染](#jump4)

[列表渲染](#jump5)

[综合案例：疫情地图](#jump6)

---	

<span id="jump1"></span>

## Props：父传子

### 特点

- 父传递给子组件数据，单向流动，不能子传递给父

- props的传值，可以是任意的类型

- Props可以设置默认值

```javascript
HelloMessage.defaultProps = {  name:”老陈”，msg：“helloworld”  }
```

注意：props可以传递函数，props可以传递父元素的函数，就可以去修改父元素的state,从而达到传递数据给父元素

### 父传子例子

父组件

```javascript
class ParentCom extends React.Component {
  constructor(props) {
    super(props)
    this.state = {
      isActive: true
    }
    this.changeShow = this.changeShow.bind(this)
  }

  render() {
    return (
      <div>
        <button onClick={this.changeShow}>控制子元素显示</button>
        <ChildCom isActive={this.state.isActive} />
      </div>
    )
  }

  changeShow() {
    this.setState({
      isActive: !this.state.isActive
    })
  }
}
```

子组件

```javascript
class ChildCom extends React.Component {
  constructor(props) {
    super(props)
  }
  render() {
    let strClass = null;
    strClass = this.props.isActive ? " active" : "";

    return (
      <div className={"content" + strClass}>
        <h1>我是子元素</h1>
      </div>
    )
  }
}
```

---

<span id="jump2"></span>

## React数据传递：子传父

调用父元素的函数从而操作父元素的数据，从而实现数据从子元素传递至父元素

父组件

```javascript
class ParentCom extends React.Component {
  constructor(props) {
    super(props)
    this.state = {
      childData: null
    }
  }

  render() {
    return (
      <div>
        <h1>子元素传递给父元素的数据：{this.state.childData}</h1>
        <ChildCom setChildData={this.setChildData} />
      </div>
    )
  }
  setChildData = (data) => {
    this.setState({
      childData: data
    })
  }
}
```

子组件

```javascript
class ChildCom extends React.Component {
  constructor(props) {
    super(props)
    this.state = {
      msg: "helloworld"
    }
  }
  render() {
    return (
      <div>
        <button onClick={this.sendData}>传递helloworld给父元素</button>
      </div>
    )
  }
  sendData = () => {
    //将子元素传递给到父元素，实际就是调用父元素传递进来的父元素函数
    this.props.setChildData(this.state.msg)
  }
}
```

---

<span id="jump3"></span>

## REACT事件

### 特点

1. react事件，绑定事件的命名，驼峰命名法

2. {},传入1个函数，而不是字符串

```javascript
<button onClick={this.sendData}>传递helloworld给父元素</button>
```

注意：
原生，阻止默认行为时，可以直接返回return false；
React中，阻止默认必须e.preventDefault();

### React事件传参数

不使用ES6箭头函数传递多个参数的方式

需要绑定this

```javascript
<button  onClick={function(e){this.parentEvent1('不使用es6,msg:helloworld',e)}.bind(this)}>提交</button>
```

使用ES6箭头函数传递多个参数

不需要绑定this，因为箭头函数的this就是外层的this

```javascript
<button  onClick={(e)=>{this.parentEvent1('msg:helloworld',e)}}>提交</button>
```

---

<span id="jump4"></span>

## React条件渲染

React中条件渲染即和JavaScript中，条件运算，如if...else...三元运算符等

1. 直接通过条件运算返回要渲染的JSX对象

2. 通过条件运算得出jsx对象，在将JSX对象渲染到模板中

通过if进行条件渲染

```javascript
function UserGreet(props) {
  return (<h1>欢迎登陆</h1>)
}

function UserLogin(props) {
  return (<h1>请先登录</h1>)
}

class ParentCom extends React.Component {
  constructor(props) {
    super(props)
    this.state = {
      isLogin: true
    }
  }
  render() {
    if (this.state.isLogin) {
      return (<UserGreet></UserGreet>)
    } else {
      return (<UserLogin></UserLogin>)
    }
  }
}
```

通过三目运算符进行条件渲染

```javascript
function UserGreet(props) {
  return (<h1>欢迎登陆</h1>)
}

function UserLogin(props) {
  return (<h1>请先登录</h1>)
}

class ParentCom extends React.Component {
  constructor(props) {
    super(props)
    this.state = {
      isLogin: false
    }
  }
  render() {
    let element = null;

    return (
      <div>
        <h1>这是头部</h1>
        <h1>这是三元运算符的操作</h1>
        {this.state.isLogin ? <UserGreet></UserGreet> : <UserLogin></UserLogin>}
        <h1>这是尾部</h1>
      </div>
    )
  }
}
```

---

<span id="jump5"></span>

## 列表渲染

- 使用数组的map方法，对每一项数据按照JSX的形式进行加工，最终得到一个每项都是JSX对象的数组，再将数组渲染到模板中

- Key值需要放置到每一项中

```javascript
class Welcome extends React.Component {
  constructor(props) {
    super(props)
    this.state = {
      list: [
        {
          title: "第一节 React事件",
          content: "事件内容"
        },
        {
          title: "第二节 React数据传递",
          content: "数据传递内容",
        },
        {
          title: "第三节 条件渲染",
          content: "条件渲染内容",
        }
      ]
    }
  }

  render() {
  	// 加工后返回给模板渲染
    return (
      <div>
        <ul>
          {	// 使用map方法对每一项数据按照JSX的形式进行加工
            this.state.list.map((item, index) => {
              return (
			  	// 遍历渲染过程中，JSX元素还可以绑定事件
                <li key={index} onClick={(event) => { this.clickFn(index, item.title, event) }}>
                  <h3>{index + 1} {item.title}</h3>
                  <p>{item.content}</p>
                </li>
              )
            })
          }
        </ul>
      </div>
    )
  }
  
  // 自定义点击事件
  clickFn = (index, title, event) => {
    alert((index + 1) + title)
  }
}
```

---

<span id="jump6"></span>

## 综合案例：疫情地图

[React制作疫情地图](https://github.com/FooderLeoYo/React-StudyNote/tree/master/assets/projects/%E7%96%AB%E6%83%85%E5%9C%B0%E5%9B%BE)
